{
  "$schema": "http://json-schema.org/draft-07/schema",
  "type": "object",
  "properties": {
    "service": {
      "type": "object",
      "properties": {
        "image": {
          "type": "object",
          "properties": {
            "version": { "type": "string" },
            "pullPolicy": { "type": "string", "enum": ["IfNotPresent", "Always", "Never"] },
            "custom": {
              "type": "object",
              "properties": {
                "enabled": { "type": "boolean" },
                "version": { "type": "string" }
              }
            }
          }
        }
      }
    },
    "postgres": {
      "type": "object",
      "properties": {
        "image": { "type": "string" },
        "database": { "type": "string" },
        "username": { "type": "string" },
        "password": { "type": "string" },
        "pgdata": { "type": "string" }
      }
    },
    "guacd": {
      "type": "object",
      "properties": {
        "image": { "type": "string" }
      }
    },
    "guacamole": {
      "type": "object",
      "properties": {
        "extensions": { "type": "string" }
      }
    },
    "extraEnvVars": {
      "type": "array",
      "default": [],
      "items": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "pattern": "^[a-zA-Z0-9_]+$" },
          "value": { "type": "string" }
        }
      }
    },
    "persistence": {
      "type": "object",
      "properties": {
        "drive": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "accessMode": { "type": "string" },
            "size": { "type": "string" },
            "storageClassName": { "type": "string" }
          }
        },
        "record": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "accessMode": { "type": "string" },
            "size": { "type": "string" },
            "storageClassName": { "type": "string" }
          }
        },
        "postgres": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "accessMode": { "type": "string" },
            "size": { "type": "string" },
            "storageClassName": { "type": "string" }
          }
        }
      }
    },
    "networking": {
      "type": "object",
      "properties": {
        "type": { "type": "string" },
        "clusterIP": { "type": "string" },
        "service": {
          "type": "object",
          "properties": {
            "port": { "type": "integer" },
            "targetPort": { "type": "integer" }
          }
        }
      }
    },
    "ingress": {
      "type": "object",
      "x-onyxia": {
        "overwriteSchemaWith": "ide/ingress.json"
      },
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true,
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "k8s.ingress"
          }
        },
        "hostname": {
          "type": "string",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "{{project.id}}-{{k8s.randomSubdomain}}-0.{{k8s.domain}}"
          }
        },
        "userHostname": {
          "type": "string",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "{{project.id}}-{{k8s.randomSubdomain}}-user.{{k8s.domain}}"
          }
        },
        "ingressClassName": {
          "type": "string",
          "default": "",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "{{k8s.ingressClassName}}"
          }
        },
        "useCertManager": {
          "type": "boolean",
          "default": false,
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "k8s.useCertManager"
          }
        },
        "certManagerClusterIssuer": {
          "type": "string",
          "default": "",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "k8s.certManagerClusterIssuer"
          }
        },
        "tls": { "type": "boolean" },
        "secretName": { "type": "string" }
      }
    },
    "route": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false,
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "k8s.route"
          }
        },
        "hostname": {
          "type": "string",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "{{project.id}}-{{k8s.randomSubdomain}}-0.{{k8s.domain}}"
          }
        },
        "userHostname": {
          "type": "string",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "{{project.id}}-{{k8s.randomSubdomain}}-user.{{k8s.domain}}"
          }
        }
      }
    }
  }
}
