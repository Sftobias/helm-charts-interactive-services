{
  "$schema": "http://json-schema.org/draft-07/schema",
  "type": "object",
  "properties": {
    "service": {
      "type": "object",
      "properties": {
        "image": {
          "type": "object",
          "properties": {
            "pullPolicy": { "type": "string", "enum": ["IfNotPresent", "Always", "Never"], "default": "IfNotPresent" },
            "version": { "type": "string", "default": "vncserver/lubuntu:latest" },
            "custom": {
              "type": "object",
              "properties": {
                "enabled": { "type": "boolean", "default": false },
                "version": { "type": "string", "default": "vncserver/lubuntu:latest" }
              }
            }
          }
        }
      }
    },
    "lubuntu": {
      "type": "object",
      "properties": {
        "vncPassword": { "type": "string", "default": "changeme" },
        "vncPort": { "type": "integer", "default": 5901 }
      }
    },
    "persistence": {
      "type": "object",
      "x-onyxia": {
        "overwriteSchemaWith": "ide/persistence.json"
      },
      "properties": {
        "enabled": {
          "title": "Create a persistent volume",
          "type": "boolean",
          "default": true
        },
        "size": {
          "title": "Persistent volume size",
          "type": "string",
          "default": "10Gi",
          "form": true,
          "render": "slider",
          "sliderMin": 1,
          "sliderMax": 100,
          "sliderStep": 1,
          "sliderUnit": "Gi",
          "x-onyxia": {
            "overwriteDefaultWith": "region.resources.disk",
            "useRegionSliderConfig": "disk"
          },
          "hidden": {
            "value": false,
            "path": "enabled",
            "isPathRelative": true
          }
        }
      }
    },
    "extraEnvVars": {
      "title": "Environment variables available within your service",
      "type": "array",
      "default": [],
      "x-onyxia": {
        "hidden": true,
        "overwriteSchemaWith": "ide/extraenv.json"
      },
      "items": {
        "title": "",
        "type": "object",
        "properties": {
          "name": { "type": "string", "default": "VAR_NAME", "pattern": "^[a-zA-Z0-9_]+$" },
          "value": { "type": "string", "default": "" }
        }
      }
    },
    "networking": {
      "type": "object",
      "x-onyxia": {
        "overwriteSchemaWith": "ide/networking.json"
      },
      "properties": {
        "type": { "type": "string" },
        "service": {
          "type": "object",
          "properties": {
            "port": { "type": "integer", "default": 5901 },
            "targetPort": { "type": "integer", "default": 5901 }
          }
        },
        "user": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "port": { "type": "integer", "default": 5901 }
          }
        }
      }
    },
    "ingress": {
      "type": "object",
      "x-onyxia": {
        "overwriteSchemaWith": "ide/ingress.json"
      },
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false,
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "k8s.ingress"
          }
        },
        "hostname": {
          "type": "string",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "{{project.id}}-{{k8s.randomSubdomain}}-0.{{k8s.domain}}"
          }
        },
        "userHostname": {
          "type": "string",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "{{project.id}}-{{k8s.randomSubdomain}}-user.{{k8s.domain}}"
          }
        },
        "ingressClassName": {
          "type": "string",
          "default": "",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "{{k8s.ingressClassName}}"
          }
        },
        "useCertManager": {
          "type": "boolean",
          "default": false,
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "k8s.useCertManager"
          }
        },
        "certManagerClusterIssuer": {
          "type": "string",
          "default": "",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "k8s.certManagerClusterIssuer"
          }
        }
      }
    },
    "route": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false,
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "k8s.route"
          }
        },
        "hostname": {
          "type": "string",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "{{project.id}}-{{k8s.randomSubdomain}}-0.{{k8s.domain}}"
          }
        },
        "userHostname": {
          "type": "string",
          "x-onyxia": {
            "hidden": true,
            "overwriteDefaultWith": "{{project.id}}-{{k8s.randomSubdomain}}-user.{{k8s.domain}}"
          }
        }
      }
    }
  }
}
